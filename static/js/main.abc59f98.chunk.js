(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){},76:function(e,t,a){},78:function(e,t,a){},79:function(e,t,a){"use strict";a.r(t);var c=a(4),s=a(2),n=a.n(s),i=a(27),r=a.n(i),o=a(12),d=(a(59),a(28)),j=a(100),l=a(91),h=a(92),b=a(93),u=a(94),O=a(95),m=a(96);a(60);var v=function(e){var t=e.isReceived,a=void 0!==t&&t,s=e.children,n=e.author,i=e.timestamp,r=["Message"];return a&&r.push("Message-Receiver"),Object(c.jsxs)("div",{className:r.join(" "),children:[Object(c.jsx)("div",{className:"Message__Author",children:n}),Object(c.jsxs)("div",{className:"Message__Inner",children:[Object(c.jsx)("span",{className:"Message__Content",children:s}),Object(c.jsx)("span",{className:"Message__Timestamp",children:i})]})]})},x=(a(61),a(9)),p=a(26),f=(p.a.initializeApp({apiKey:"AIzaSyBTf9gET7N1S6fBQTOHOlHWNar2l9IJuwc",authDomain:"react-chat-8f283.firebaseapp.com",databaseURL:"https://react-chat-8f283.firebaseio.com",projectId:"react-chat-8f283",storageBucket:"react-chat-8f283.appspot.com",messagingSenderId:"151504121252",appId:"1:151504121252:web:889c61d8448f66d587e531"}),p.a.firestore()),_=p.a.auth(),g=new p.a.auth.GoogleAuthProvider,N=f,S=Object(s.createContext)(void 0);function C(e){var t=e.reducer,a=e.initialState,n=e.children;return Object(c.jsx)(S.Provider,{value:Object(s.useReducer)(t,a),children:n})}var w=function(){return Object(s.useContext)(S)},y=a(39),I=a.n(y);function A(e){var t,a,n;Object(d.a)(e);var i=Object(s.useState)(""),r=Object(o.a)(i,2),f=r[0],_=r[1],g=Object(x.f)().roomId,S=Object(s.useState)(""),C=Object(o.a)(S,2),y=C[0],A=C[1],L=Object(s.useState)([]),k=Object(o.a)(L,2),R=k[0],H=k[1],M=w(),T=Object(o.a)(M,1)[0].user;Object(s.useEffect)((function(){return g&&(N.collection("rooms").doc(g).onSnapshot((function(e){var t,a;A(null!==(t=null===(a=e.data())||void 0===a?void 0:a.name)&&void 0!==t?t:"")})),N.collection("rooms").doc(g).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){H(e.docs.map((function(e){return e.data()})))}))),function(){}}),[g]);var B=I()(null!==(t=null===(a=R[R.length-1])||void 0===a||null===(n=a.timestamp)||void 0===n?void 0:n.toDate())&&void 0!==t?t:Date.now()).fromNow();return Object(c.jsx)("div",{className:"Chat",children:y?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"Chat__Header",children:[Object(c.jsx)(j.a,{src:"https://avatars.dicebear.com/api/avataaars/".concat(y,".svg")}),Object(c.jsxs)("div",{className:"Chat__HeaderInfo",children:[Object(c.jsx)("div",{className:"Chat__HeaderName",children:y}),Object(c.jsx)("div",{className:"Chat__HeaderLastDate",children:B})]}),Object(c.jsxs)("div",{className:"Chat__HeaderRight",children:[Object(c.jsx)(l.a,{children:Object(c.jsx)(h.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(b.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(u.a,{})})]})]}),Object(c.jsx)("div",{className:"Chat__Body",children:R.map((function(e){var t,a;return Object(c.jsx)(v,{author:e.author,timestamp:I()(null!==(t=null===(a=e.timestamp)||void 0===a?void 0:a.toDate())&&void 0!==t?t:Date.now()).fromNow(),isReceived:T.displayName===e.author,children:e.content},e.content)}))}),Object(c.jsxs)("div",{className:"Chat__Footer",children:[Object(c.jsx)(l.a,{children:Object(c.jsx)(O.a,{})}),Object(c.jsxs)("form",{children:[Object(c.jsx)("input",{type:"text",value:f,onChange:function(e){_(e.target.value)}}),Object(c.jsx)("button",{type:"submit",onClick:function(e){if(e.preventDefault(),f.length){if(f.length>100)return void alert("Your message so loooong...");N.collection("rooms").doc(g).collection("messages").add({author:T.displayName,content:f,timestamp:p.a.firestore.FieldValue.serverTimestamp()}),_("")}},children:"Send a message"})]}),Object(c.jsx)(l.a,{children:Object(c.jsx)(m.a,{})})]})]}):Object(c.jsx)("div",{children:"Empty"})})}var L=a(97),k=a(98),R=(a(74),a(31));a(75);function H(e){var t=e.addNewChat,a=void 0!==t&&t,n=e.name,i=void 0===n?"":n,r=e.id,d=void 0===r?"":r,l=Object(s.useState)(""),h=Object(o.a)(l,2),b=(h[0],h[1]),u=Object(s.useState)(""),O=Object(o.a)(u,2),m=O[0],v=O[1];return Object(s.useEffect)((function(){d&&N.collection("rooms").doc(d).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){var t,a,c=e.docs.map((function(e){return e.data()}));v(null!==(t=null===(a=c[0])||void 0===a?void 0:a.content)&&void 0!==t?t:"")}))}),[]),a?Object(c.jsx)("div",{onClick:function(){var e=prompt("Please enter name for chat");if(b("".concat(Math.random())),e){if(e.length>20)return void alert("Room name is sooo long...");N.collection("rooms").add({name:e})}},className:"SidebarChat__AddNew",children:Object(c.jsx)("h2",{children:"Add new chat"})}):Object(c.jsx)(R.b,{to:"/rooms/".concat(d),className:"SidebarChat__Link",children:Object(c.jsxs)("div",{className:"SidebarChat",children:[Object(c.jsx)(j.a,{src:"https://avatars.dicebear.com/api/avataaars/".concat(i,".svg")}),Object(c.jsxs)("div",{className:"SidebarChat__Info",children:[Object(c.jsx)("h3",{className:"SidebarChat__Nickname",children:i}),Object(c.jsx)("p",{className:"SidebarChat__Message",children:m})]})]})})}var M=function(e){Object(d.a)(e);var t=Object(s.useState)([]),a=Object(o.a)(t,2),n=a[0],i=a[1],r=w(),b=Object(o.a)(r,1)[0].user;return console.log(b),Object(s.useEffect)((function(){var e=N.collection("rooms").onSnapshot((function(e){i(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}));return function(){e()}}),[]),Object(c.jsxs)("div",{className:"Sidebar",children:[Object(c.jsxs)("div",{className:"Sidebar__Header",children:[Object(c.jsxs)("div",{className:"Sidebar__UserInfo",children:[Object(c.jsx)(j.a,{src:b.photoURL}),Object(c.jsx)("span",{children:b.displayName})]}),Object(c.jsxs)("div",{className:"Sidebar_HeaderRight",children:[Object(c.jsx)(l.a,{children:Object(c.jsx)(L.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(k.a,{})}),Object(c.jsx)(l.a,{children:Object(c.jsx)(u.a,{})})]})]}),Object(c.jsx)("div",{className:"Sidebar__Search",children:Object(c.jsxs)("div",{className:"Sidebar__SearchContainer",children:[Object(c.jsx)(h.a,{}),Object(c.jsx)("input",{placeholder:"Search or start new chat",type:"text"})]})}),Object(c.jsxs)("div",{className:"Sidebar__Chats",children:[Object(c.jsx)(H,{addNewChat:!0}),n.map((function(e){return Object(c.jsx)(H,{name:e.data.name,id:e.id},e.id)}))]})]})},T=a(99),B=a(42),D="SET_USER",E=function(e,t){switch(t.type){case D:return Object(B.a)(Object(B.a)({},e),{},{user:t.user});default:return e}};a(76);function F(e){Object(d.a)(e);var t=w(),a=Object(o.a)(t,2)[1];return Object(c.jsx)("div",{className:"Login",children:Object(c.jsxs)("div",{className:"Login__Container",children:[Object(c.jsx)("img",{className:"Login__Logo",src:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/598px-WhatsApp.svg.png",alt:""}),Object(c.jsx)("div",{className:"Login__Text",children:Object(c.jsx)("h1",{children:"Sign in to WhatsApp"})}),Object(c.jsx)(T.a,{className:"Login__Action",onClick:function(){_.signInWithPopup(g).then((function(e){a({type:D,user:e.user})}))},children:"Sign in with Google"})]})})}var P=function(){var e=w(),t=Object(o.a)(e,1)[0].user;return Object(c.jsx)("div",{className:"App",children:t?Object(c.jsx)("div",{className:"App__Wrapper",children:Object(c.jsxs)(R.a,{children:[Object(c.jsx)(M,{}),Object(c.jsxs)(x.c,{children:[Object(c.jsx)(x.a,{path:"/rooms/:roomId",children:Object(c.jsx)(A,{})}),Object(c.jsx)(x.a,{path:"/",children:Object(c.jsx)(A,{})})]})]})}):Object(c.jsx)(F,{})})},W=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,101)).then((function(t){var a=t.getCLS,c=t.getFID,s=t.getFCP,n=t.getLCP,i=t.getTTFB;a(e),c(e),s(e),n(e),i(e)}))};a(77),a(78);r.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)(C,{reducer:E,initialState:{user:null},children:Object(c.jsx)(P,{})})}),document.getElementById("root")),W()}},[[79,1,2]]]);
//# sourceMappingURL=main.abc59f98.chunk.js.map